<section class="page users">
  <header class="page__header">
    <h1 class="page__title">Manage Users</h1>
    <p class="page__subtitle">Search, filter, and manage user account status.</p>
  </header>

  <div class="toolbar" role="region" aria-label="User filters">
    <div class="search-container">
      <input
        type="text"
        class="search-input"
        placeholder="Search by name or email..."
        [(ngModel)]="searchTerm"
        (input)="applyFilters()"
        aria-label="Search users by name or email" />
    </div>

    <div class="filter-container">
      <label for="status" class="filter-label">Filter by status:</label>
      <select id="status"
              class="filter-select"
              [(ngModel)]="statusFilter"
              (change)="applyFilters()"
              aria-label="Filter users by status">
        <option value="all">All</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
    </div>
  </div>

  <div *ngIf="isLoading" class="loading-container" role="status" aria-live="polite">
    <div class="spinner" aria-hidden="true"></div>
    <p>Loading users...</p>
  </div>

  <div *ngIf="!isLoading">
    <div *ngIf="filteredUsers.length > 0; else noUsers" class="table-container">
      <!-- Add .table for consistent styling with global CSS -->
      <table class="table users-table">
        <thead>
          <tr>
            <th scope="col">Name</th>
            <th scope="col">Email</th>
            <th scope="col">Status</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of filteredUsers; trackBy: trackByUserId">
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>
              <span class="status" [ngClass]="user.isActive ? 'active' : 'inactive'">
                {{ user.isActive ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td>
              <button
                class="action-btn"
                [class.deactivate-btn]="user.isActive"
                [class.activate-btn]="!user.isActive"
                (click)="toggleUserStatus(user)">
                {{ user.isActive ? 'Deactivate' : 'Activate' }}
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #noUsers>
      <div class="empty-state" role="status" aria-live="polite">
        <h2>No Users Found</h2>
        <p>No users match your current search and filter criteria.</p>
      </div>
    </ng-template>
  </div>
</section>